/* モバイル最適化CSS */
/* その他の問題修正と全体最適化 */

/* ========================================
   1. ボタンとタップ領域の最適化
   ======================================== */

@media (max-width: 768px) {
    
    /* すべてのボタンのタップ領域を最適化 */
    button,
    .btn,
    a.btn,
    input[type="submit"],
    input[type="button"] {
        min-height: 44px !important;
        min-width: 44px !important;
        padding: 0.75rem 1.5rem !important;
        font-size: 16px !important;
        line-height: 1.4 !important;
        border-radius: 6px !important;
        cursor: pointer !important;
        touch-action: manipulation !important;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1) !important;
    }
    
    /* リンクのタップ領域 */
    a {
        min-height: 44px !important;
        display: inline-flex !important;
        align-items: center !important;
        padding: 0.5rem !important;
        touch-action: manipulation !important;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1) !important;
    }
    
    /* ナビゲーションリンクの最適化 */
    .nav-link,
    .header-nav a,
    .main-nav a {
        min-height: 48px !important;
        padding: 0.75rem 1rem !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        text-align: center !important;
        border-radius: 6px !important;
        margin: 0.25rem !important;
    }
    
    /* アイコンボタンの最適化 */
    .icon-btn,
    .social-link,
    .share-btn {
        width: 48px !important;
        height: 48px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        border-radius: 50% !important;
    }
}

/* ========================================
   2. 画像とメディアの最適化
   ======================================== */

@media (max-width: 768px) {
    
    /* すべての画像をレスポンシブに */
    img {
        max-width: 100% !important;
        height: auto !important;
        display: block !important;
        margin: 0 auto !important;
        border-radius: 4px !important;
    }
    
    /* ヒーロー画像の最適化 */
    .hero-character img,
    .hero-image img {
        max-width: 250px !important;
        margin: 1rem auto !important;
    }
    
    /* ロゴの最適化 */
    .logo-img {
        max-height: 40px !important;
        width: auto !important;
        margin: 0 !important;
    }
    
    /* アイコンの最適化 */
    .icon,
    .fas,
    .far,
    .fab {
        font-size: 1.25rem !important;
        line-height: 1 !important;
    }
    
    /* 画像の読み込み最適化 */
    img[loading="lazy"] {
        opacity: 0 !important;
        transition: opacity 0.3s ease !important;
    }
    
    img[loading="lazy"].loaded {
        opacity: 1 !important;
    }
    
    /* 画像エラー時のスタイル */
    img.error {
        background-color: #f3f4f6 !important;
        border: 1px solid #e5e7eb !important;
        position: relative !important;
    }
    
    img.error::after {
        content: "画像を読み込めませんでした" !important;
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) !important;
        font-size: 12px !important;
        color: #6b7280 !important;
        text-align: center !important;
    }
}

/* ========================================
   3. フォームの最適化
   ======================================== */

@media (max-width: 768px) {
    
    /* フォーム要素の最適化 */
    input,
    textarea,
    select {
        width: 100% !important;
        min-height: 44px !important;
        padding: 0.75rem !important;
        font-size: 16px !important;
        line-height: 1.4 !important;
        border: 2px solid #e2e8f0 !important;
        border-radius: 6px !important;
        background-color: #ffffff !important;
        color: #2d3748 !important;
        box-sizing: border-box !important;
        -webkit-appearance: none !important;
        appearance: none !important;
    }
    
    /* フォーカス状態 */
    input:focus,
    textarea:focus,
    select:focus {
        outline: none !important;
        border-color: #3182ce !important;
        box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1) !important;
    }
    
    /* ラベルの最適化 */
    label {
        display: block !important;
        font-weight: 600 !important;
        margin-bottom: 0.5rem !important;
        color: #2d3748 !important;
        font-size: 16px !important;
    }
    
    /* エラー状態 */
    input.error,
    textarea.error,
    select.error {
        border-color: #e53e3e !important;
        background-color: #fed7d7 !important;
    }
    
    .error-message {
        color: #e53e3e !important;
        font-size: 14px !important;
        margin-top: 0.25rem !important;
        display: block !important;
    }
}

/* ========================================
   4. テーブルの最適化
   ======================================== */

@media (max-width: 768px) {
    
    /* テーブルをスクロール可能に */
    .table-container {
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch !important;
        margin: 1rem 0 !important;
        border-radius: 6px !important;
        border: 1px solid #e2e8f0 !important;
    }
    
    table {
        min-width: 600px !important;
        width: 100% !important;
        border-collapse: collapse !important;
        font-size: 14px !important;
    }
    
    th,
    td {
        padding: 0.75rem !important;
        text-align: left !important;
        border-bottom: 1px solid #e2e8f0 !important;
        white-space: nowrap !important;
    }
    
    th {
        background-color: #f8fafc !important;
        font-weight: 600 !important;
        color: #2d3748 !important;
    }
    
    /* レスポンシブテーブル（カード形式） */
    .responsive-table {
        display: block !important;
        overflow-x: visible !important;
    }
    
    .responsive-table thead {
        display: none !important;
    }
    
    .responsive-table tbody,
    .responsive-table tr,
    .responsive-table td {
        display: block !important;
        width: 100% !important;
    }
    
    .responsive-table tr {
        margin-bottom: 1rem !important;
        padding: 1rem !important;
        background-color: #ffffff !important;
        border: 1px solid #e2e8f0 !important;
        border-radius: 6px !important;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    }
    
    .responsive-table td {
        padding: 0.5rem 0 !important;
        border: none !important;
        white-space: normal !important;
    }
    
    .responsive-table td::before {
        content: attr(data-label) ": " !important;
        font-weight: 600 !important;
        color: #4a5568 !important;
    }
}

/* ========================================
   5. パフォーマンス最適化
   ======================================== */

@media (max-width: 768px) {
    
    /* アニメーションの最適化 */
    * {
        -webkit-transform: translateZ(0) !important;
        transform: translateZ(0) !important;
        -webkit-backface-visibility: hidden !important;
        backface-visibility: hidden !important;
    }
    
    /* スクロールの最適化 */
    body {
        -webkit-overflow-scrolling: touch !important;
        scroll-behavior: smooth !important;
    }
    
    /* タッチ操作の最適化 */
    * {
        -webkit-touch-callout: none !important;
        -webkit-user-select: none !important;
        -khtml-user-select: none !important;
        -moz-user-select: none !important;
        -ms-user-select: none !important;
        user-select: none !important;
    }
    
    /* テキスト選択は許可 */
    p,
    h1, h2, h3, h4, h5, h6,
    span,
    li,
    td,
    th,
    input,
    textarea {
        -webkit-user-select: text !important;
        -khtml-user-select: text !important;
        -moz-user-select: text !important;
        -ms-user-select: text !important;
        user-select: text !important;
    }
    
    /* GPU加速の最適化 */
    .hero-section,
    .mobile-menu,
    .mobile-menu-overlay,
    .content-card,
    .service-card {
        -webkit-transform: translate3d(0, 0, 0) !important;
        transform: translate3d(0, 0, 0) !important;
        will-change: transform !important;
    }
}

/* ========================================
   6. アクセシビリティの向上
   ======================================== */

@media (max-width: 768px) {
    
    /* フォーカス表示の改善 */
    *:focus {
        outline: 2px solid #3182ce !important;
        outline-offset: 2px !important;
    }
    
    /* スキップリンク */
    .skip-link {
        position: absolute !important;
        top: -40px !important;
        left: 6px !important;
        background: #3182ce !important;
        color: #ffffff !important;
        padding: 8px !important;
        text-decoration: none !important;
        border-radius: 4px !important;
        z-index: 10000 !important;
    }
    
    .skip-link:focus {
        top: 6px !important;
    }
    
    /* 高コントラストモード対応 */
    @media (prefers-contrast: high) {
        * {
            border-color: #000000 !important;
        }
        
        .btn,
        button {
            border: 2px solid #000000 !important;
        }
        
        a {
            text-decoration: underline !important;
            text-decoration-thickness: 2px !important;
        }
    }
    
    /* 動きを減らす設定への対応 */
    @media (prefers-reduced-motion: reduce) {
        * {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
            scroll-behavior: auto !important;
        }
    }
}

/* ========================================
   7. 印刷対応
   ======================================== */

@media print {
    
    /* 不要な要素を非表示 */
    .mobile-menu-btn,
    .mobile-menu,
    .mobile-menu-overlay,
    .header-nav,
    .floating-character,
    .sticky-cta {
        display: none !important;
    }
    
    /* 印刷用のスタイル */
    body {
        font-size: 12pt !important;
        line-height: 1.5 !important;
        color: #000000 !important;
        background: #ffffff !important;
    }
    
    h1, h2, h3, h4, h5, h6 {
        color: #000000 !important;
        page-break-after: avoid !important;
    }
    
    p, li {
        orphans: 3 !important;
        widows: 3 !important;
    }
    
    img {
        max-width: 100% !important;
        page-break-inside: avoid !important;
    }
    
    a {
        color: #000000 !important;
        text-decoration: underline !important;
    }
    
    a[href^="http"]:after {
        content: " (" attr(href) ")" !important;
        font-size: 10pt !important;
        color: #666666 !important;
    }
}

/* ========================================
   8. 最終的な強制修正
   ======================================== */

@media (max-width: 768px) {
    
    /* 横スクロールの防止 */
    html,
    body {
        overflow-x: hidden !important;
        max-width: 100vw !important;
    }
    
    /* すべてのコンテナの幅制限 */
    * {
        max-width: 100% !important;
        box-sizing: border-box !important;
    }
    
    /* フレックスボックスの修正 */
    .flex,
    .d-flex {
        flex-wrap: wrap !important;
        gap: 1rem !important;
    }
    
    /* グリッドレイアウトの修正 */
    .grid,
    .row {
        display: flex !important;
        flex-direction: column !important;
        gap: 1rem !important;
    }
    
    /* 固定要素の調整 */
    .fixed,
    .sticky {
        position: relative !important;
    }
    
    /* z-indexの調整 */
    .mobile-menu-btn {
        z-index: 10001 !important;
    }
    
    .mobile-menu {
        z-index: 10000 !important;
    }
    
    .mobile-menu-overlay {
        z-index: 9999 !important;
    }
}

